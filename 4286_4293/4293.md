# CS4293: Topics on Cybersecurity

[TOC]

## Lecture 01: Introdunction and Basic Crypto Tools

* P19-p23: Tools for **confidentiality**

  * Encryption
  * Acess control: Control what the users with a “need to know”
  * Authorization: Person or system is allowed access to resources
  * Physical security: Limit access to protected computational resources

* P20: 

  * e.g. prone <=(https)=> Server (transforme video stream or web pages)
  * s in https means SSL(Secure socket layer)
  * https doe not consider side channel attack, for video streaming case, if two continous frame are similar, the traffic payload is lower. => use the traffic pattern to analize which video you are watching (Website fingerprinter is another case)

* P25: Tools for **Integrity**

  * Backups
  * Checksums
  * Data correcting codes: Methods for storing data in such a way that small changes can be easily detected and automatically corrected

* P26: Tools for **Availability**

  * Physical protections
  * Computational redundancies: computers and storage devices that serve as fallbacks (後備) in the case of failures.

* P28: **Assurance**: refers to how trust is provided and managed in computer systems. Which depends on

  * Policies: e.g. describe how users can access and copy songs.
  * Permissions: e.g. an online music store may provide permissions for limited access and copying to people who have purchased certain songs
  * Protections: Enforce policies and permissions

* P29: **Authenticity** is the ability to determine that **statements, policies, and permissions issued by persons or systems** are genuine.

* P30: **Anonymity**: Good property, but hard to achieve

  * Aggregation: the combining of data from many individuals so that disclosed **sums or averages** cannot be tied to any individual.

  * Mixing: the **intertwining**(mix) of transactions, information, or communications in a way that cannot be traced to any individual.

  * Proxies: **trusted agents** that are willing to engage in actions for an individual in a way that cannot be traced back to that person.

    ![image-20200315134313894](assets/image-20200315134313894.png)

  * Pseudonyms: fictional identities that can **fill in for real identities in communications and transactions, but are otherwise known only to a trusted entity.** 

* P31 - P36 Threats and Attacks - Services

  * Eavesdropping - Confidentiality: the interception(截取) of information intended for someone else during its transmission over a communication channel.

  * Alteration - Integrity: e.g. man-in-the-middle attack

  * DoS - Availability

  * Masquerading - Data entity authentication

  * Repudiation - Non-repudiation

  * Correlation and traceback - Anonymity: the integration of multiple data sources and information flows to determine the source of a particular data stream or piece of information.

    ![Screenshot 2020-03-15 at 1.49.25 PM](assets/Screenshot%202020-03-15%20at%201.49.25%20PM.png)

* P38 - P47: The Ten Security Principles

  * **Economy** of mechanism:  simplicity in the design and implementation of security measures
  * **Fail-safe** defaults: the default configuration of a system should have a conservative protection scheme. e.g.: new added user is assigned to minimal access right
  * **Complete** mediation: every access to a resource must be checked for compliance with a protection scheme. e.g. – For example, an online banking web site should require users to sign on again after a certain amount of time, say, 15 minutes, has elapsed.
  * **Open** design: the security architecture and design of a system should be made **publicly available**. (Algorithm is known to public but still cannot break)
  * **Separation of privilege**: **multiple conditions** should be required to achieve access to restricted resources or have a program perform some action.
  * **Least privilege**: Each program and user of a computer system should operate with the bare minimum privileges necessary to function properly. e.g.: No more privilege
  * **Least common mechanism**: In systems with multiple users, mechanisms allowing resources to be shared by more than one user **should be minimized.** 
  * **Psychological acceptability**: user interfaces should be well designed and intuitive, and all security-related settings should adhere to what an ordinary user might expect.
  * **Work factor**: the cost of circumventing a security mechanism should be compared with the resources of an attacker when designing a security scheme. (cost to break > protected resource)
  * **Compromise recording**: sometimes it is more desirable to **record the details of an intrusion than to adopt more sophisticated measures to prevent it**. 

* P69: Digital Certificates: Make sure the public key is certified (bind public key to a person)

* Secure Password

  * Common means for authentication 
  * Usually stored via hash values 
  * long psw. + odd char. are better and safer

* P77: Social Engineering

  * Pretexting: creating a story that convinces an **administrator or operator** into revealing secret information. 
  * Baiting: offering a kind of “gift” to get **a user or agent** to perform an insecure action. 
  * Quid pro quo: **offering an action or service and then expecting something in return.**

-------------

## Lecture02: Basic Crypto Tools

* P5: 

  * Plaintext length typically the same as ciphertext length 
  * Encryption and decryption are PRP, i.e., pseudorandom permutation functions (bijections), on the set of all n-bit arrays
  * Efficiency: functions $E_K$ and $D_K$ should have efficient algorithms
  * Consistency: Decrypting the ciphertext yields the plaintext

* P6:

  * Never use a proprietary cipher(not public known algorithm)
  * nonce is a.k.a IV

* P7: Use cases

  * Single use key: (one time key) 
    * Key is only used to encrypt one message (encrypted email: new key generated for every email)
    * **No need for nonce** (set to 0) 
  * Multi use key: (many time key)
    * Key used to encrypt multiple messages (SSL: same key used to encrypt many packets)
    * Need either **unique nonce or random nonce**

* P8: Types of attacks

  * Ciphertext only attack
  * Known plaintext attack
  * Chosen plaintext attack
  * Chosen ciphertext attack

* P12: Substitution Boxes (apply substitution cipher on binary numbers), a.k.a. S-boxes

* P13 - P15: 

  * One-time pad is acctually using a block of shift keys $(k_1, k_2, …, k_n)$ to encrypt a plaintext, $M$, of length $n$, with each shift key being chosen uniformly at random.
  * Ciphertext = (Key + plaintext) mod 26
  * For binary case, this operation is just XOR
  * OTP is “secure” against cipher text-only attacks => All possible key-plaintext pairs make sence

* Weakness of OTP

  * Length of the key need to be the same as the plaintext
  * Key can never be reused
  * Key management is difficult (Problems in generation & safe distribution of keys.)

* P17 - P19: Steam cipher

  * Advantage
    * Solves the problem of key size for OTP
    * Key stream is unpredictable without the key
    * Computation is fast, code is simple
    * Suitable for plaintext of arbitrary length generated on the fly, e.g., media stream – processes input elements continuously
  * Disadvantage
    * Stream ciphers should single use key, danger when the key is used twice, XOR ciphertext to get the XORed message and do further analysis

* P20: Key stream generation

  * RC4
  * Block cipher in counter mode: Synchronous stream cipher
    * Key stream only from secret key
    * Works for unreliable channels if plaintext has packets **with sequence numbers**

* P23: Padding should be removable: 

  * When the block size and plaintext length are a multiple of 8, a common padding method (PKCS5) is a sequence of identical bytes, each indicating the length (in bytes) of the padding
  * We need to always pad the last block, which may consist only of padding (to avoid same result before and after padding)

* P24: Size of `3DES` is `168 bits`

  ![Screenshot 2020-03-15 at 6.35.34 PM](assets/Screenshot%202020-03-15%20at%206.35.34%20PM.png)

* P26: Block cipher round: **For each block**, block cipher will do the operation for many rounds, each round use a different round key by using key expansion

  ![Screenshot 2020-03-15 at 6.39.16 PM](assets/Screenshot%202020-03-15%20at%206.39.16%20PM.png)

* **P37: PRF and PRP**

  * Pseudorandom Function (PRF): $F: K \times X \mapsto Y$ is such that: exists “efficient” algorithm to evaluate $F(K,x)$ 

  * Pseudorandom Permutation Function (PRP): $F: K \times X \mapsto X$ such that

    * Exists “efficient” algorithm to evaluate $E(k, x)$
    * The function $E(k, .)$ is one-to-one
    * Exists “efficient” algorithm for inverse $D(k,x)$
    * A block cipher is a PRP

  * Secure Pseudorandom Function (PRF): $F: K \times X \mapsto Y$ is such that: $F(k, .)$ is **indistinguishable** from a true random function $f: x \mapsto Y$ 

    ![Screenshot 2020-03-15 at 6.59.50 PM](assets/Screenshot%202020-03-15%20at%206.59.50%20PM.png)

  * Secure Pseudorandom Permutation Function (PRP): $F: K \times X \mapsto X$ such that $E(k, .)$ is indistinguishable from a random permutation $\pi: X\mapsto X$ 

  * PRF Switching lemma: A secure PRP is also a secure PRF => AES and 3DES are secure PRFs

  * An example of non-secure PRF

    ![Screenshot 2020-03-15 at 7.00.48 PM](assets/Screenshot%202020-03-15%20at%207.00.48%20PM.png)

* P50: How to choose IV

  * Single use key: Do not need IV

  * Mult use key: Use a fresh random IV for every messages, and send IV together with the cipher texts 

    * Also can use unique and non-random IV (e.g. counter)

    * But then first step in CBC must be $IV^\prime \leftarrow E(k_1, IV)$

    * Benefit: may save transmitting $IV$ with ciphertext

    * e.g. share both $K$ and $K_1$, and synchronize the choice of initial counter $IV$, which might start with $1,2,3,…$ for message $1,2,3….$ (each time encrypt the counter by using $K_1$, and use the result as $IV$)

      ![Screenshot 2020-03-15 at 7.14.23 PM](assets/Screenshot%202020-03-15%20at%207.14.23%20PM.png)

* P53: Counter mode: Used in high-speed network encryptions (parallel encryption but fix the problem of ECB (same input result in different output))

* P81: PMAC - Parallel MAC: ECBC and HMAC are sequtial 

  ![Screenshot 2020-03-15 at 8.23.51 PM](assets/Screenshot%202020-03-15%20at%208.23.51%20PM.png)

* P88: Implementation attacks: Powercryptanalysis

  * Powerconsumption depends on instruction and data
  * Measure power consumption during block cipher operation
  * About 1000 ciphertexts suffice to expose secret key

* P95: The escrow is a trusted agency, if you forget the key, it can be used to recover the key

* **P113 - 119**:  Notice the definition of trapdoor function (TDF); A textbook RSA (RSA without hash) is not truly randomnize encryption, a better method is to use textbook RSA combined with **hash function and symmetric encryption**

  ![Screenshot 2020-03-15 at 9.37.07 PM](assets/Screenshot%202020-03-15%20at%209.37.07%20PM.png)

  * Randomly select $x$: $x \in _ R X$
  * encrypt by textbook RSA: $y \leftarrow RSA(p_k, x)$ => $x \leftarrow RSA(s_k, y)$
  * Use hash function generate a key: $k \leftarrow H(x)$ (Same for both side)
  * Use the key as symmetric encryption key: $c \leftarrow E_s(k, m)$ => $m \leftarrow D_s(k, m)$
  * output $(y,c)$ 
  * The point is use RSA to share the information to construct the key
  * Advantage
    * Fast to compute (borrow from symmetric encryption)
    * Safe, same input will result in different output

* **P124: The $H$ function is not simply hash, it contains two steps**

  * First apply normal hash $h(M)$, which result in says `256-bits` digest
  * The apply an internal step to make to `1024/2048-bits` integer

* P127: Digital signature based certificates is widely used in web browser

  ![Screenshot 2020-03-15 at 9.56.30 PM](assets/Screenshot%202020-03-15%20at%209.56.30%20PM.png)

  * Motivation: Prove the public key of Bob is actually belong to Bob

  * Solution: PKI

    * Trusted root authority (VeriSign, IBM, United Nations) 
      * Everyone must know the verification key of root authority 
      * Check your browser; there are hundreds!! 
    * Root authority can sign certificates
    * Certificates identify **others, including other authorities**
    * Leads to **certificate chains** (verify the certificate of certificate … )

  * Method: The server send its public key to CA, CA sign the public key by using CA’s private key. User verify the public key of server by using the public key of CA. Then use the public key of server verify the message

    ![Screenshot 2020-03-15 at 10.01.27 PM](assets/Screenshot%202020-03-15%20at%2010.01.27%20PM.png)

  * Potential threat: PKI cannot provide absolute security

    * If CA is not well added to your browser, bad CA may give bad certificates
    * It is very cheap, even free to get one Digital Certificate 
    * Attackers can still compromise the CA

* P133: Limitations of Cryptography

  * Most security problems are not crypto problems
    * pros: cryptography works
    * cons: people make other mistakes which cannot be solved by crypto
  * Misuse of cryptography is fatal for security
    * WEP – ineffective, highly embarrassing for industry
    * Occasional unexpected attacks on systems subjected to serious review

* 

